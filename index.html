<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Clone</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #131314;
            --sidebar-bg: #1e1f20;
            --text-color: #e3e3e3;
            --secondary-text: #c4c7c5;
            --hover-bg: #282a2c;
            --active-bg: #004a77;
            --input-bg: #1e1f20;
            --accent-color: #a8c7fa;
            --user-msg-bg: #282a2c;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Sidebar --- */
        #sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            padding: 20px 10px;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .new-chat-btn {
            background-color: var(--hover-bg);
            color: var(--secondary-text);
            border: 1px solid transparent;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 20px;
            transition: background 0.2s;
        }

        .new-chat-btn:hover {
            background-color: #333537;
            color: var(--text-color);
        }

        .chat-list-label {
            font-size: 12px;
            color: var(--secondary-text);
            padding: 0 10px;
            margin-bottom: 10px;
        }

        #chat-history {
            flex-grow: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .chat-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 15px;
            border-radius: 50px;
            cursor: pointer;
            color: var(--text-color);
            font-size: 14px;
            position: relative;
            text-decoration: none;
        }

        .chat-item:hover, .chat-item.active {
            background-color: var(--hover-bg);
        }
        
        .chat-item.active {
            font-weight: 600;
            background-color: #2c2e30;
        }

        .chat-title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 160px;
            pointer-events: none; /* Let the parent handle click */
        }

        .chat-options-btn {
            background: none;
            border: none;
            color: var(--secondary-text);
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
        }

        .chat-item:hover .chat-options-btn, .chat-item.active .chat-options-btn {
            display: flex;
        }

        .chat-options-btn:hover {
            background-color: #3c4043;
            color: white;
        }

        /* Dropdown Menu */
        .dropdown-menu {
            position: absolute;
            right: 10px;
            top: 35px;
            background-color: #2d2e30;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            z-index: 100;
            display: none;
            flex-direction: column;
            min-width: 120px;
            overflow: hidden;
        }

        .dropdown-menu.show {
            display: flex;
        }

        .dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dropdown-item:hover {
            background-color: #3c4043;
        }

        .dropdown-item.delete {
            color: #ff8b8b;
        }

        /* --- Main Chat Area --- */
        #main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            background-color: var(--bg-color);
        }

        header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--secondary-text);
        }

        #chat-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            opacity: 1;
            transition: opacity 0.3s;
        }

        .welcome-text {
            font-size: 56px;
            background: linear-gradient(90deg, #4285f4, #9b72cb, #d96570);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .welcome-subtext {
            font-size: 24px;
            color: #5f6368;
        }

        .message-wrapper {
            width: 100%;
            max-width: 800px;
            display: flex;
            gap: 15px;
            animation: fadeIn 0.3s ease;
        }

        .message-wrapper.user {
            justify-content: flex-end;
        }

        .message-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .ai-icon {
            background: linear-gradient(135deg, #4285f4, #d96570);
        }

        .user-icon {
            background-color: #5f6368;
        }

        .message-content {
            line-height: 1.6;
            font-size: 16px;
            color: var(--text-color);
        }

        .user .message-content {
            background-color: var(--user-msg-bg);
            padding: 10px 20px;
            border-radius: 20px 20px 5px 20px;
        }

        /* --- Input Area --- */
        #input-container {
            padding: 20px;
            display: flex;
            justify-content: center;
            background-color: var(--bg-color);
        }

        .input-box {
            width: 100%;
            max-width: 800px;
            background-color: var(--input-bg);
            border-radius: 50px;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid transparent;
            transition: border 0.2s;
        }

        .input-box:focus-within {
            background-color: #282a2c;
            border-color: #5f6368;
        }

        #message-input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: white;
            font-size: 16px;
            outline: none;
        }

        #send-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--secondary-text);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }

        #send-btn:hover {
            color: white;
        }

        #send-btn.active {
            color: var(--accent-color);
        }

        /* --- Icons --- */
        svg {
            pointer-events: none;
        }
        
        .chat-options-btn svg {
            pointer-events: none;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #444746;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #5f6368;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            #sidebar {
                position: absolute;
                left: -260px;
                height: 100%;
                z-index: 1000;
                box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            }
            #sidebar.open {
                transform: translateX(260px);
            }
            #mobile-menu-btn {
                display: block;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Rename Modal */
        #rename-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        .modal-content {
            background: #2d2e30;
            padding: 20px;
            border-radius: 12px;
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .modal-title { font-size: 18px; font-weight: 600; }
        .modal-input {
            padding: 10px;
            background: #1e1f20;
            border: 1px solid #5f6368;
            color: white;
            border-radius: 6px;
            outline: none;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            border: none;
            font-size: 14px;
        }
        .btn-cancel { background: transparent; color: #a8c7fa; }
        .btn-confirm { background: #a8c7fa; color: #000; font-weight: 500; }

    </style>
</head>
<body>

    <!-- Sidebar -->
    <aside id="sidebar">
        <button class="new-chat-btn" onclick="startNewChat()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            New Chat
        </button>

        <div class="chat-list-label">Recent</div>
        <div id="chat-history">
            <!-- Chat items will be injected here via JS -->
        </div>
    </aside>

    <!-- Main Content -->
    <main id="main-content">
        <header>
            <div id="mobile-menu-btn" style="display:none; cursor:pointer;" onclick="toggleSidebar()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                </svg>
            </div>
            <div style="font-weight: 500; font-size: 18px;">Gemini Clone</div>
            <div class="user-icon" style="width: 32px; height: 32px; border-radius: 50%; overflow: hidden;">
                <!-- Placeholder for user profile -->
                <svg viewBox="0 0 24 24" fill="#ccc" width="32" height="32"><circle cx="12" cy="12" r="12"/></svg>
            </div>
        </header>

        <div id="chat-container">
            <div id="welcome-message" class="welcome-screen">
                <div class="welcome-text">Hello, User</div>
                <div class="welcome-subtext">How can I help you today?</div>
            </div>
            <div id="messages-list" style="width: 100%; display: flex; flex-direction: column; align-items: center; gap: 20px;"></div>
        </div>

        <div id="input-container">
            <div class="input-box">
                <input type="text" id="message-input" placeholder="Enter a prompt here" autocomplete="off">
                <button id="send-btn" onclick="handleSendMessage()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                </button>
            </div>
        </div>
    </main>

    <!-- Rename Modal -->
    <div id="rename-modal">
        <div class="modal-content">
            <div class="modal-title">Rename Chat</div>
            <input type="text" id="rename-input" class="modal-input" placeholder="Chat Name">
            <div class="modal-actions">
                <button class="btn btn-cancel" onclick="closeRenameModal()">Cancel</button>
                <button class="btn btn-confirm" onclick="confirmRename()">Rename</button>
            </div>
        </div>
    </div>

    <script>
        // State
        let chats = [];
        let currentChatId = null;
        let contextMenuOpenId = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load from local storage if exists (Mock)
            // chats = JSON.parse(localStorage.getItem('gemini-chats')) || [];
            
            // Create a default chat if empty
            if (chats.length === 0) {
                createNewChat('New Chat');
            } else {
                renderSidebar();
                loadChat(chats[0].id);
            }

            // Input enter key listener
            document.getElementById('message-input').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    handleSendMessage();
                }
            });

            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.chat-options-btn') && !e.target.closest('.dropdown-menu')) {
                    closeAllDropdowns();
                }
            });
        });

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function createNewChat(title = 'New Chat') {
            const newChat = {
                id: generateId(),
                title: title,
                messages: []
            };
            chats.unshift(newChat); // Add to top
            currentChatId = newChat.id;
            renderSidebar();
            loadChat(currentChatId);
        }

        function startNewChat() {
            // Only create new if current isn't empty
            const currentChat = chats.find(c => c.id === currentChatId);
            if (currentChat && currentChat.messages.length === 0) return;
            
            createNewChat();
        }

        function renderSidebar() {
            const container = document.getElementById('chat-history');
            container.innerHTML = '';

            chats.forEach(chat => {
                const isActive = chat.id === currentChatId ? 'active' : '';
                
                const div = document.createElement('div');
                div.className = `chat-item ${isActive}`;
                div.onclick = (e) => {
                    // Prevent loading if clicking the menu button
                    if(e.target.closest('.chat-options-btn') || e.target.closest('.dropdown-menu')) return;
                    loadChat(chat.id);
                };

                div.innerHTML = `
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 10px; flex-shrink:0;">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span class="chat-title">${chat.title}</span>
                    <button class="chat-options-btn" onclick="toggleMenu('${chat.id}', this)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="2"/>
                            <circle cx="12" cy="5" r="2"/>
                            <circle cx="12" cy="19" r="2"/>
                        </svg>
                    </button>
                    <!-- Dropdown -->
                    <div class="dropdown-menu" id="menu-${chat.id}">
                        <div class="dropdown-item" onclick="openRenameModal('${chat.id}')">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Rename
                        </div>
                        <div class="dropdown-item delete" onclick="deleteChat('${chat.id}')">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                            Delete
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function loadChat(id) {
            currentChatId = id;
            const chat = chats.find(c => c.id === id);
            
            // Highlight active in sidebar
            document.querySelectorAll('.chat-item').forEach(el => el.classList.remove('active'));
            // Re-render sidebar to update active class (lazy way) or find element
            renderSidebar();

            const welcomeMsg = document.getElementById('welcome-message');
            const messagesList = document.getElementById('messages-list');
            messagesList.innerHTML = '';

            if (chat.messages.length === 0) {
                welcomeMsg.style.display = 'flex';
            } else {
                welcomeMsg.style.display = 'none';
                chat.messages.forEach(msg => renderMessage(msg.text, msg.sender));
            }
        }

        function renderMessage(text, sender) {
            const container = document.getElementById('messages-list');
            const wrapper = document.createElement('div');
            wrapper.className = `message-wrapper ${sender}`;
            
            // Icon
            const icon = document.createElement('div');
            icon.className = `message-icon ${sender === 'user' ? 'user-icon' : 'ai-icon'}`;
            // Simple SVG logic for icons
            if(sender === 'ai') {
                 icon.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 16l-2.5-1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"/></svg>`;
            } else {
                 icon.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="white"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`;
            }

            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerText = text;

            if (sender === 'ai') {
                wrapper.appendChild(icon);
                wrapper.appendChild(content);
            } else {
                wrapper.appendChild(content);
                wrapper.appendChild(icon);
            }

            container.appendChild(wrapper);
            
            // Scroll to bottom
            const chatContainer = document.getElementById('chat-container');
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function handleSendMessage() {
            const input = document.getElementById('message-input');
            const text = input.value.trim();
            if (!text) return;

            // 1. Add User Message
            const chat = chats.find(c => c.id === currentChatId);
            chat.messages.push({ text: text, sender: 'user' });
            
            // Update UI
            document.getElementById('welcome-message').style.display = 'none';
            renderMessage(text, 'user');
            input.value = '';

            // Update title if it's the first message and still named "New Chat"
            if (chat.messages.length === 1 && chat.title === 'New Chat') {
                chat.title = text.substring(0, 20) + (text.length > 20 ? '...' : '');
                renderSidebar();
            }

            // 2. Simulate AI Response
            setTimeout(() => {
                const response = "I am a simulated Gemini response. I can help you code, write, and plan.";
                chat.messages.push({ text: response, sender: 'ai' });
                renderMessage(response, 'ai');
            }, 1000);
        }

        // --- Menu Logic ---

        function toggleMenu(chatId, btn) {
            // Close others
            closeAllDropdowns();
            
            const menu = document.getElementById(`menu-${chatId}`);
            if (menu.style.display === 'flex') {
                menu.style.display = 'none';
            } else {
                menu.style.display = 'flex';
                menu.classList.add('show');
            }
        }

        function closeAllDropdowns() {
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                menu.style.display = 'none';
                menu.classList.remove('show');
            });
        }

        function deleteChat(id) {
            chats = chats.filter(c => c.id !== id);
            
            // If we deleted the current chat
            if (currentChatId === id) {
                if (chats.length > 0) {
                    loadChat(chats[0].id);
                } else {
                    createNewChat();
                }
            } else {
                renderSidebar();
            }
        }

        // --- Rename Modal Logic ---
        let chatToRenameId = null;

        function openRenameModal(id) {
            chatToRenameId = id;
            const chat = chats.find(c => c.id === id);
            document.getElementById('rename-input').value = chat.title;
            document.getElementById('rename-modal').style.display = 'flex';
            document.getElementById('rename-input').focus();
            closeAllDropdowns();
        }

        function closeRenameModal() {
            document.getElementById('rename-modal').style.display = 'none';
            chatToRenameId = null;
        }

        function confirmRename() {
            if (!chatToRenameId) return;
            const newName = document.getElementById('rename-input').value.trim();
            if (newName) {
                const chat = chats.find(c => c.id === chatToRenameId);
                chat.title = newName;
                renderSidebar();
            }
            closeRenameModal();
        }

        // --- Mobile Logic ---
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
            // If open on mobile, add left: 0
            if (sidebar.classList.contains('open')) {
                sidebar.style.transform = 'translateX(260px)';
            } else {
                sidebar.style.transform = 'translateX(0)';
            }
        }

    </script>
</body>
</html>